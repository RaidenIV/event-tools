<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OFFER PDF Generator</title>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.umd.min.js"></script>
    <style>
        body {
            font-family: 'Rajdhani', sans-serif;
            width: 75%;
            margin: 0 auto;
            padding: 20px 5%;
            background: white;  /* Updated: Black background for space around form */
            max-width: none; /* Full-width for webpage feel */
        }
        h1 { text-align: center; color: #030303; }  /* Keep h1 dark for form contrast, or change to white if needed */
        p { text-align: center; max-width: 800px; margin: 0 auto 20px; color: #000000; }  /* White for body text */
        form {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            width: 40%;
            box-sizing: border-box;
            margin: 0 auto;
        }
        label { font-weight: bold; display: block; margin-top: 15px; color: #333; }
        input, select {
            width: 100%;
            padding: 12px;
            margin-top: 5px;
            box-sizing: border-box;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        .checkbox {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }
        .checkbox input[type="checkbox"] { width: auto; margin-right: 10px; }
        button {
            background: #228B22;
            color: white;
            padding: 15px;
            border: none;
            cursor: pointer;
            margin-top: 25px;
            width: 100%;
            font-size: 18px;
            border-radius: 4px;
            font-weight: bold;
        }
        button:hover { background: #1e7a1e; }
        @media (max-width: 768px) {
            body { padding: 20px 3%; }
            form { padding: 20px; }
            label { font-size: 14px; }
        }
    </style>
</head>
<body>
    <h1>Offer PDF Generator</h1>
    <p>Fill in the details below to generate a talent offer PDF sheet.</p>
    <form id="offerForm">
        <label for="headliner">Headliner Name (e.g., AKIRAH):</label>
        <input type="text" id="headliner" required>
        <label for="date">Date (MM/DD/YYYY, e.g., 08/01/2026):</label>
        <input type="date" id="date" required>
        <label for="ticketPrice">Ticket Price (e.g., 30):</label>
        <input type="text" id="ticketPrice">
        <label for="setTime">Set Time (e.g., 12:30-1:30am):</label>
        <input type="text" id="setTime">
        <label for="offerAmount">Offer Amount (e.g., 2000):</label>
        <input type="text" id="offerAmount">
        <div class="checkbox">
            <input type="checkbox" id="hgr">
            <label for="hgr">Include + HGR</label>
        </div>
        <label for="additionalTerms">Additional Terms (e.g., 1000 at sellout):</label>
        <input type="text" id="additionalTerms">
        <button type="submit">Generate PDF</button>
    </form>
    <script>
        // Set min date to today (prevents past dates)
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('date').min = today;

        // Helper function to format YYYY-MM-DD to MM/DD/YYYY
        function formatDate(isoDate) {
            if (!isoDate) return '';
            const [year, month, day] = isoDate.split('-');
            return `${month}/${day}/${year}`;
        }

        // Base64 for your logoâ€”replace with your actual encoded PNG
        const logoBase64 = ''
        // Fixed venue/promoter data (customize as needed)
        const venueData = {
            name: "Skully's Music Diner",
            address: "1151 N High St, Columbus, OH 43201",
            phone: "(614) 291-8856",
            capacity: "650",
            times: "8-2am",
            age: "18+"
        };
        const promoterData = {
            name: "XODIA Media Group",
            address: "5897 Shadow Lake Circle, Columbus, Ohio 43235",
            website: "https://xodiamediagroup.com",  // Full URL for linking; display shortened below
            phone: "(614) 204-5395",
            email: "xodia.mg@gmail.com",
            signatory: "Dante Evans - XODIA Media Group (@xodiamg)"
        };
        const legalTerms = [
            "Deposit amount not to exceed 50% of guarantee and paid in full the following Wednesday after show.",
            "Artist is not to perform within 180 miles of this venue 30 days prior or following scheduled play date.",
            "Artist will give XODIA 1st chance to bid on talent to maintain history for followup market plays.",
            "Offer expires 10 days after sent."
        ];
        document.getElementById('offerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            // Gather inputs
            const headliner = document.getElementById('headliner').value.trim().toUpperCase();
            const rawDate = document.getElementById('date').value.trim();
            const formattedDate = formatDate(rawDate);  // Convert to MM/DD/YYYY for PDF/filename
            let ticketPrice = document.getElementById('ticketPrice').value.trim();
            const setTime = document.getElementById('setTime').value.trim();
            let offerAmount = document.getElementById('offerAmount').value.trim();
            const hgr = document.getElementById('hgr').checked;
            let additionalTerms = document.getElementById('additionalTerms').value.trim();
            // Auto-format $ (friendly validation)
            if (ticketPrice && !ticketPrice.startsWith('$') && /^\d+(\.\d{1,2})?$/.test(ticketPrice)) ticketPrice = `$${ticketPrice}`;
            if (offerAmount && !offerAmount.startsWith('$') && /^\d+(\.\d{1,2})?$/.test(offerAmount)) offerAmount = `$${offerAmount}`;
            if (hgr) offerAmount += ' + HGR';
            if (additionalTerms && !additionalTerms.startsWith('$') && /^\d+(\.\d{1,2})?$/.test(additionalTerms.split(' ')[0])) additionalTerms = `$${additionalTerms}`;
            // Validate required
            if (!headliner || !rawDate) {
                alert('Headliner and Date are required!');
                return;
            }
            // Generate PDF
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            // Add logo (base64 for easy embedding)
            if (logoBase64) {
                doc.addImage(logoBase64, 'PNG', 85, 5, 40, 15); // Centered, scaled
            }
            // Centered title
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(16);
            doc.text('TALENT OFFER SHEET', 105, 35, { align: 'center' });
            // Spacing controls (tweak these numbers as needed)
            const START_Y_AFTER_TITLE = 50;  // Space after title
            const LINE_HEIGHT_WITHIN_SECTION = 5;  // Space between label & value
            const SPACE_BETWEEN_SECTIONS = 6;  // Gap after each full section (increased for more space)
            const LEGAL_TERM_SPACING = 5;  // Vertical space per legal date
            let yPos = START_Y_AFTER_TITLE;
            // Updated sectionY function with variables
            const sectionY = (text, value, y) => {
                doc.setFont('helvetica', 'bold');
                doc.setFontSize(10);
                doc.text(`${text}`, 10, y);
                doc.setFont('helvetica', 'normal');
                doc.setFontSize(10);
                doc.text(value, 10, y + LINE_HEIGHT_WITHIN_SECTION);  // Uses variable for intra-section space
                return y + (LINE_HEIGHT_WITHIN_SECTION + SPACE_BETWEEN_SECTIONS);  // Total advance per section
            };
            // Artist/Date/Hold
            yPos = sectionY('Artist: ', headliner, yPos);
            yPos = sectionY('Date: ', formattedDate, yPos);  // Use formatted date
            yPos = sectionY('Hold: ', 'H1', yPos);
            // Venue sections
            yPos = sectionY('Venue Name: ', venueData.name, yPos);
            yPos = sectionY('Venue Address: ', venueData.address, yPos);
            yPos = sectionY('Venue Phone: ', venueData.phone, yPos);
            yPos = sectionY('Venue Capacity: ', venueData.capacity, yPos);
            yPos = sectionY('Venue Times: ', venueData.times, yPos);
            yPos = sectionY('Age Requirements: ', venueData.age, yPos);
            yPos = sectionY('Ticket Price: ', ticketPrice || '', yPos);
            yPos = sectionY('Set Times: ', setTime, yPos);
            yPos = sectionY('Offer: ', offerAmount, yPos);
            yPos = sectionY('Additional Terms: ', additionalTerms, yPos);
            // Promoter sections (with special handling for Website link)
            yPos = sectionY('Promoter Name: ', promoterData.name, yPos);
            yPos = sectionY('Promoter Address: ', promoterData.address, yPos);
            // Custom rendering for Promoter Website (displays short text, links full URL)
            let websiteY = yPos;
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(10);
            doc.text('Promoter Website: ', 10, websiteY);
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(10);
            const fullWebsiteUrl = promoterData.website;  // Full URL for linking
            const displayWebsiteText = fullWebsiteUrl.replace('https://', '').replace('http://', '').replace('www.', '');  // Short display: "xodiamediagroup.com"
            const websiteX = 10;
            const websiteTextY = websiteY + LINE_HEIGHT_WITHIN_SECTION;
            doc.text(displayWebsiteText, websiteX, websiteTextY);
            // Add clickable link over the displayed website text
            const websiteWidth = doc.getTextWidth(displayWebsiteText);
            const linkHeight = 4;  // Padding for easy clicking
            const linkY = websiteTextY - 2;  // Center vertically over text
            doc.link(websiteX, linkY, websiteWidth, linkHeight, { url: fullWebsiteUrl });
            yPos = websiteY + (LINE_HEIGHT_WITHIN_SECTION + SPACE_BETWEEN_SECTIONS);
            // Rest of Promoter sections
            yPos = sectionY('Promoter Phone: ', promoterData.phone, yPos);
            yPos = sectionY('Promoter Email: ', promoterData.email, yPos);
            yPos = sectionY('Promoter Signatory: ', promoterData.signatory, yPos);
            // Updated Legal terms with variable spacing
            doc.setFont('arial', 'bold');
            doc.setFontSize(10);
            doc.text('Standard Terms: ', 10, yPos);
            doc.setFont('arial', 'normal');
            yPos += LINE_HEIGHT_WITHIN_SECTION;  // Consistent with section spacing
            legalTerms.forEach(term => {
                doc.text(term, 10, yPos);
                yPos += LEGAL_TERM_SPACING;  // Uses variable for term gaps
            });
            // Full-width save with local file choice (Blob + temp link for save dialog)
            const filename = `${headliner}_offer_${formattedDate.replace(/\//g, '-')}.pdf`;  // Use formatted date
            const pdfBlob = doc.output('blob');
            const url = URL.createObjectURL(pdfBlob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            alert(`Success! PDF saved to your local computer: ${filename}`); // Confirmation
        });
    </script>
</body>
</html>
